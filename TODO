T	computer doesn't attack regions
	which units to order should not be determined with unit_importance (units must be diverse; too many units consume too much food)
T	levidon map
F	find the crash at the end of the animation
	*** stack smashing detected ***: /home/martin/dev/conquest_of_levidon/src/conquest_of_levidon terminate
	#0  0x00007ffff692d0a7 in raise () from /lib64/libc.so.6
	#1  0x00007ffff692e419 in abort () from /lib64/libc.so.6
	#2  0x00007ffff696bd88 in __libc_message () from /lib64/libc.so.6
	#3  0x00007ffff69f3e87 in __fortify_fail () from /lib64/libc.so.6
	#4  0x00007ffff69f3e50 in __stack_chk_fail () from /lib64/libc.so.6
	#5  0x000000000041b614 in input_animation (game=0x7fffffffe080, battle=0x7ffffffeea50, movements=0x8f7150) at input_battle.c:344
H	don't allow pawns to attack their own walls (currently only gates are not attacked)
	separate constants for BLOCKAGE_WALL and BLOCKAGE_GATE
H	don't allow attacking if the attacker cannot do damage to the defender (due to weapon and armor type)
H	use a separate thread to calculate computer turns while the local player is choosing what to play
	add indicator (e.g. lighted bulb) for the players who have completed their turn
H	better support for hotseat (show animations to each player, warn before changing current player and showing their map, choose player names, etc.)
H	error reporting on invalid map
H	handle different screen resolutions better
H	region population
	income should be calculated as a function of the population
	one should be able to tell the population which resource to produce
	better food mechanics; food should not be accumulated indefinately
H	improve auto combat
H	melee units should go closer to the shooter to prevent them from escaping far enough to shoot
M	region-specific features (income, population, units, buildings, battlefield)
	population growth
	army recruitment should reduce population
	use BLOCKAGE_TERRAIN
M	improve AI (formation AI, etc.)
M	retreat can be abused for scouting (25 peasants can go and retreat for 1 food)
	maybe make retreat take some time (1 or 2 rounds); that way only fast units will be able to retreat
	maybe allow retreat only when the pawns are near the border of the battlefield?
	currently attackers retreating from an assault are killed; is this okay?
M	editor: position region neighbors properly
M	make formation consistent with the new battle mechanics
M	do something when there is not enough food for all units (?kill some units)
M	assault towers
M	map scrolling
M	keyboard support in various places in the interface; mouse support in various places in the interface
M	network game (using SCTP?)
M	improve world loading/saving
	support JSON comments
	log (level error) the line on which parse error occurs
	log (level error) when a compulsory field is not present or has the wrong type
	log (level warning) when an optional field has the wrong type; assume the field is not present for the execution logic
	refactor (simplify) the code using these ideas
M	catapult, balista
M	add ACTION_GUARD in battle
	the pawn is told an area which to guard; if an enemy goes into that area, the pawn sets ACTION_FIGHT on that enemy (this may happen in the middle between rounds)
L	limited number of shots
L	assault garrison destruction and repair
L	armory, swordsman, crossbowman, heavy cavalry, horse archer
L	assault moat
L	sound
L	water; naval battles
L	roads
L	trade
L	religions, ethnicities, languages
L	dynamic alliances
L	seasons
L	? buildings should not generate income on the day they are built
L	? implement exit game while in battle
L	make palisade invisible when fortress is built

bugs
	F battle AI
		battle between human with peasant and computer with militia; rating is sometimes > 1
			because no rating_max is added for player action
	F horses on the battlefield lead to buffer overflow? (probably the same bug as the crash above; unrelated to AI; some of the memory is zeroed after movement animation)
		the crash is caused by setting state.traversed in input_animation() when one of the coordinates is rounded to 25
	F shooter moves after shooting (because moves was set; I should unset it)

? dynamic battlefield size
? deal damage to each pawn escaping from enemy pawns

refactoring
	use 'struct point' only for drawing (draw.h) (fix point_eq calls)
		remove struct region dependency on struct point by moving center and location_garrison into location
	split BLOCKAGE_OBSTACLE into BLOCAKGE_GATE and BLOCKAGE_WALL; change combat_order_assault (there is a todo)
	make it simpler to check if two players are allies
	? rename image to sprite
	? change direction of everything to counterclockwise; currently the y axis is in the opposite direction (and the cross product is negated)
	? redesign input functions (handling mouse movement is tedious; handling writing should be unified; can I unify the two input functions?)
	? unify ACTION_FIGHT and ACTION_ASSAULT

-- interface --

custom mouse pointer
improve player colors
player names and flag patterns
support different resolutions

button input bottom and right coordinates should be exclusive (... - 1)

images
	fortress*.png, fortress_gate*.png
	assault indicator on the map

menu
	directory tabs images
	display minimap

battle
	when two pawns from different alliances are next to each other, display red line between them (to show that they are fighting)
	fight animation (display which units are fighting)
	hide mouse pointer during animation
	display round number
	enemy on the gate not displayed during shooting in battle animation
	support showing more pawn stats (not just health)
	new pawn images
	change image for pawn selection
	new wall and gate images; open gate image
	? movement and shoot animation is faster when its duration is shorter
	tell all players if somebody is retreating
	think about displaying reachable locations for a pawn
	add battlefield animation indication when an enemy pawn makes a pawn stop (due to collision)
	display calculated pawn moves (not a straight line)

report
	display minimap
	in battle report, display which players retreated (maybe show white flag)
	group players by alliances and show indicator for the alliance

map
	village image (will be displayed to the left of troops bar)
	more tooltips
	display current month and year
	right clicking on a garrison on the map should be the same as clicking for assault
	indicate on the map which region is selected (maybe with a border around it?)
	show region-specific expenses
	support showing troop stats
	redesign arrows showing troop movement
	improve boxes for field and garrison troops (it's not obvious one can place units there until there are units)
	one should be able to tell all troops to go on assault
